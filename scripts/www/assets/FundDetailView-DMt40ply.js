import{_ as He,w as j,o as Ze,m as pe,a as qe,C as Ge,b as c,c as v,d as t,u as ne,t as a,n as R,f as F,F as P,r as M,p as Q,k as p,v as w,q as W,s as O,e as Ke,x as Qe,h as g,j as Xe,i as C}from"./index-CRAB7jjQ.js";import"./auto-DTlAZPGd.js";import{a as et,b as tt,c as lt,d as st,e as at}from"./data-DyJSRnoA.js";import{b as ot}from"./jsonpCallbackGenerator-Bt3BN9dH.js";import{u as nt}from"./fundStore-B47IS5EL.js";const rt={class:"fund-detail"},ut={class:"fixed top-0 left-0 right-0 z-50 detail-header"},dt={class:"px-0 py-0"},it={class:"flex items-center justify-between px-4 py-4"},ct={class:"text-center max-w-[200px] flex-1"},vt={class:"text-lg font-bold truncate"},ft={class:"text-sm opacity-90"},mt={class:"container mx-auto md:px-4 py-6 pt-16"},pt={key:0,class:"text-center py-8"},bt={key:1,class:"space-y-4"},xt={class:"bg-white rounded-xl p-5 card-shadow"},gt={class:"grid grid-cols-3 gap-4 mb-6"},yt={class:"text-center p-3"},ht={class:"text-xl font-bold"},wt={class:"text-center p-3"},kt={class:"text-center p-3"},Ct={class:"text-xl font-bold"},St={key:0,class:"grid grid-cols-3 gap-4 mb-6"},Dt={class:"text-center p-3"},Ft={class:"text-center p-3"},_t={class:"text-lg font-bold"},Tt={class:"text-center p-3"},At={class:"text-lg font-bold"},Nt={class:"bg-white rounded-xl p-5 card-shadow"},Vt={class:"time-scroll-container mb-6"},Rt={class:"flex space-x-2"},Pt=["onClick"],jt={class:"chart-container"},Mt={class:"bg-white rounded-xl p-5 card-shadow"},Ut={class:"flex items-center justify-between mb-4"},$t={class:"overflow-x-auto"},It={class:"w-full"},Ot={class:"py-3 px-2 text-sm"},Lt={class:"py-3 px-2 text-sm font-medium"},Jt={class:"py-3 px-2 text-sm font-medium"},zt={class:"py-3 px-2"},Bt={key:0},Wt={key:0,class:"bg-white rounded-xl p-5 card-shadow"},Yt={class:"flex flex-wrap gap-2"},Et=["onClick"],Ht={key:1,class:"bg-white rounded-xl p-5 card-shadow"},Zt={class:"space-y-3"},qt={class:"flex-1"},Gt={class:"flex justify-between items-center mb-1"},Kt={class:"font-medium"},Qt={class:"flex justify-between text-sm"},Xt={class:"font-mono text-gray-600"},el={class:"text-gray-500"},tl={class:"text-blue-600 font-medium"},ll={class:"bg-white rounded-xl p-5 card-shadow"},sl={class:"grid grid-cols-2 gap-4"},al={class:"flex justify-between items-center py-2 border-b border-gray-100"},ol={class:"font-medium"},nl={class:"flex justify-between items-center py-2 border-b border-gray-100"},rl={class:"font-medium"},ul={class:"flex justify-between items-center py-2 border-b border-gray-100"},dl={class:"font-medium"},il={class:"flex justify-between items-center py-2 border-b border-gray-100"},cl={class:"font-medium"},vl={class:"flex justify-between items-center py-2 border-b border-gray-100"},fl={class:"font-medium"},ml={class:"flex justify-between items-center py-2 border-b border-gray-100"},pl={class:"font-medium"},bl={key:2,class:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 p-4 z-40"},xl={class:"max-w-md mx-auto"},gl={class:"grid grid-cols-5 gap-2"},yl={key:2,class:"h-20"},hl={key:0,class:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"},wl={class:"bg-white rounded-xl p-6 w-full max-w-sm"},kl={class:"space-y-4"},Cl={class:"flex gap-3 mt-6"},Sl={key:1,class:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"},Dl={class:"bg-white rounded-xl p-6 w-full max-w-sm"},Fl={class:"space-y-4"},_l={class:"text-xs text-gray-500 mt-1"},Tl={class:"text-xs text-gray-500 mt-1"},Al={class:"flex gap-2"},Nl={class:"text-xs text-gray-500 mt-1"},Vl={class:"bg-gray-50 rounded-lg p-3"},Rl={class:"flex justify-between text-sm"},Pl={class:"font-medium"},jl={class:"flex justify-between text-sm mt-1"},Ml={class:"font-medium text-orange-600"},Ul={class:"flex justify-between text-sm mt-1 font-bold border-t border-gray-200 pt-2"},$l={class:"text-blue-600"},Il=["max","min"],Ol={class:"flex gap-3"},Ll={class:"flex items-center"},Jl={class:"flex items-center"},zl={class:"text-xs text-gray-500 mt-1"},Bl={class:"flex gap-3 mt-6"},Wl={key:2,class:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"},Yl={class:"bg-white rounded-xl p-6 w-full max-w-sm"},El={class:"space-y-4"},Hl={class:"block text-sm text-neutral mb-2"},Zl={class:"grid grid-cols-4 gap-2"},ql=["onClick"],Gl={class:"text-xs text-gray-500 mt-1"},Kl={class:"flex gap-2"},Ql={class:"text-xs text-gray-500 mt-1"},Xl={class:"bg-gray-50 rounded-lg p-3"},es={class:"flex justify-between text-sm"},ts={class:"font-medium"},ls={class:"flex justify-between text-sm mt-1"},ss={class:"font-medium text-orange-600"},as={class:"flex justify-between text-sm mt-1 font-bold"},os={class:"text-blue-600"},ns=["max","min"],rs={class:"flex gap-3"},us={class:"flex items-center"},ds={class:"flex items-center"},is={class:"text-xs text-gray-500 mt-1"},cs={class:"flex gap-3 mt-6"},vs={key:3,class:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"},fs={class:"bg-white rounded-xl p-6 w-full max-w-sm"},ms={class:"space-y-4"},ps={class:"text-xs text-gray-500 mt-1"},bs={class:"flex gap-2"},xs={class:"text-xs text-gray-500 mt-1"},gs={class:"bg-gray-50 rounded-lg p-3"},ys={class:"grid grid-cols-2 gap-4 text-sm"},hs={class:"flex justify-between"},ws={class:"font-medium"},ks={class:"flex justify-between"},Cs={class:"font-medium text-orange-600"},Ss={class:"space-y-3"},Ds={class:"grid grid-cols-2 gap-3"},Fs={class:"relative"},_s={key:0,class:"relative"},Ts={class:"block text-xs text-gray-500 mb-1"},As=["value"],Ns={key:1},Vs={class:"flex gap-3 mt-6"},Rs={key:4,class:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"},Ps={class:"bg-white rounded-xl p-6 w-full max-w-sm"},js={class:"space-y-4"},Ms={class:"block text-sm text-neutral mb-2"},Us={class:"grid grid-cols-4 gap-2"},$s=["onClick"],Is={class:"flex gap-2"},Os={class:"bg-gray-50 rounded-lg p-3"},Ls={class:"flex justify-between text-sm"},Js={class:"font-medium"},zs={class:"flex justify-between text-sm mt-1"},Bs={class:"font-medium text-orange-600"},Ws={class:"flex justify-between text-sm mt-1 font-bold"},Ys={class:"text-blue-600"},Es=["max","min"],Hs={class:"flex gap-3"},Zs={class:"flex items-center"},qs={class:"flex items-center"},Gs={class:"text-xs text-gray-500 mt-1"},Ks={class:"flex gap-3 mt-6"},Qs={__name:"FundDetailView",setup(Xs){const re={relatedSectors:[{name:"消费",change:2.35},{name:"科技",change:1.82},{name:"医药",change:-.45},{name:"新能源",change:3.15},{name:"金融",change:.68},{name:"制造业",change:1.42},{name:"互联网",change:2.18},{name:"半导体",change:1.95}]},X=Qe(),Y=Xe(),k=nt(),y=X.params.code,ee=g(!0),r=g({}),N=g({}),_=g({}),L=g([]),te=g([]),E=g("year"),H=g(!1),Z=g(null),le=g([]),J=g(!1),z=g(!1),U=g(!1),B=g(!1),$=g(!1),T=g({holdShare:0,costPrice:0,holdDays:0}),u=g({amount:null,fundType:"A",feeRate:.15,buyDate:"",buyTime:"before3"}),n=g({share:null,percentage:"",fundType:"A",feeRate:.5,sellDate:"",sellTime:"before3"}),be=[{label:"1/2",value:"0.5"},{label:"1/3",value:"0.3333"},{label:"1/4",value:"0.25"},{label:"全部",value:"1"}],xe=l=>{n.value.percentage=l.value,r.value.holdShare&&(n.value.share=r.value.holdShare*parseFloat(l.value))},d=g({amount:null,cycle:"",day:1,fundType:"A",feeRate:.15}),o=g({share:null,percentage:"",fromFundType:"A",toFundType:"A",feeRate:.5,targetCode:"",convertDate:"",convertTime:"before3"}),ge=[{label:"1/2",value:"0.5"},{label:"1/3",value:"0.3333"},{label:"1/4",value:"0.25"},{label:"全部",value:"1"}],ye=l=>{o.value.percentage=l.value,r.value.holdShare&&(o.value.share=r.value.holdShare*parseFloat(l.value))};if(X.params.fund)r.value=JSON.parse(decodeURIComponent(X.params.fund));else{const l=k.holdFunds.find(e=>e.code===y);l&&(r.value={...l})}j(J,l=>{l&&(T.value={holdShare:r.value.holdShare||0,costPrice:r.value.costPrice||0,holdDays:r.value.holdDays||0})}),j(z,l=>{if(l){const e=new Date;u.value.buyDate=e.toISOString().split("T")[0]}}),j(U,l=>{if(l){const e=new Date;n.value.sellDate=e.toISOString().split("T")[0],n.value.share=null,n.value.percentage=""}}),j(B,l=>{if(l){const e=new Date;d.value.day=e.getDate()}}),j(()=>u.value.fundType,l=>{l==="C"?u.value.feeRate=0:l==="A"&&u.value.feeRate===0&&(u.value.feeRate=.15)}),j(()=>d.value.fundType,l=>{l==="C"?d.value.feeRate=0:l==="A"&&d.value.feeRate===0&&(d.value.feeRate=.15)}),j($,l=>{if(l){const e=new Date;o.value.convertDate=e.toISOString().split("T")[0],o.value.share=null,o.value.percentage="",o.value.targetCode=""}});const ue=C(()=>JSON.parse(localStorage.getItem("favoriteFunds")||"[]").some(e=>e.code===y)),he=C(()=>H.value?L.value:L.value.slice(0,10)),A=(l,e=2)=>l==null||isNaN(l)?e===2?"0.00":"0.0000":parseFloat(l).toFixed(e).replace(/\B(?=(\d{3})+(?!\d))/g,","),q=l=>{if(l==null||isNaN(l))return"0.00%";const e=parseFloat(l);return`${e>=0?"+":""}${e.toFixed(2)}%`},V=l=>l==null||isNaN(l)?"¥0.00":"¥"+parseFloat(l).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,","),G=l=>l==null||isNaN(l)?"percent-neutral":parseFloat(l)>=0?"percent-rise":"percent-fall",we=l=>l==null||isNaN(l)?"percent-neutral":parseFloat(l)>=0?"percent-rise":"percent-fall",ke=C(()=>{if(!u.value.amount||u.value.amount<=0)return"0.00";const l=u.value.amount,e=se.value,i=(l-e)/b.value;return A(i,2)}),se=C(()=>{if(!u.value.amount||u.value.amount<=0)return 0;const l=(u.value.feeRate||0)/100;return u.value.amount*l}),ae=C(()=>new Date().toISOString().split("T")[0]),oe=C(()=>{const l=new Date;return l.setDate(l.getDate()-30),l.toISOString().split("T")[0]}),de=C(()=>{if(!n.value.share||n.value.share<=0)return 0;const l=n.value.share*b.value,e=(n.value.feeRate||0)/100;return l*e}),Ce=C(()=>{if(!n.value.share||n.value.share<=0)return 0;const l=n.value.share*b.value,e=de.value;return l-e}),ie=C(()=>{if(!o.value.share||o.value.share<=0)return 0;const l=o.value.share*b.value,e=(o.value.feeRate||0)/100;return l*e}),Se=C(()=>{if(!o.value.share||o.value.share<=0)return 0;const l=o.value.share*b.value,e=ie.value;return l-e}),De=C(()=>{const l=new Date;return new Date(l.getFullYear(),l.getMonth()+1,0).getDate()}),Fe=()=>{switch(d.value.cycle){case"daily":return"定投时间";case"weekly":return"选择星期";case"biweekly":return"选择星期";case"monthly":return"选择日期";default:return"选择设置"}},_e=()=>{switch(d.value.cycle){case"daily":return[{label:"每天",value:1}];case"weekly":return[{label:"周一",value:1},{label:"周二",value:2},{label:"周三",value:3},{label:"周四",value:4},{label:"周五",value:5}];case"biweekly":return[{label:"周一",value:1},{label:"周二",value:2},{label:"周三",value:3},{label:"周四",value:4},{label:"周五",value:5}];case"monthly":const l=[];for(let e=1;e<=De.value;e++)l.push({label:`${e}日`,value:e});return l;default:return[]}},ce=C(()=>{if(!d.value.amount||d.value.amount<=0)return 0;const l=(d.value.feeRate||0)/100;return d.value.amount*l}),Te=C(()=>{if(!d.value.amount||d.value.amount<=0)return"0.00";const l=d.value.amount,e=ce.value,i=(l-e)/b.value;return A(i,2)}),Ae=re.detailTimePeriods,ve=g(re.relatedSectors);let h=null;Ze(async()=>{await Ne(),await pe(),me(E.value)}),qe(()=>{h&&(h.destroy(),h=null)});const Ne=async()=>{try{ee.value=!1,await Ve(),await Pe(),await Ue(),await Re()}catch(l){console.error("加载基金数据失败:",l)}finally{ee.value=!1}},Ve=async()=>{try{const e=(await et(y,1,10)).data;e.ErrCode===0&&(L.value=e.Data.LSJZList.map(s=>({date:s.FSRQ,nav:s.DWJZ,accumulatedNav:s.LJJZ,change:s.JZZZL})))}catch(l){throw console.error("获取基金净值失败:",l),l}},Re=async()=>{const l=await tt(y);if(console.log("cc:",l),l&&l.content){const e=l.content.match(/id\s*=\s*["']?\s*gpdmList\s*["']?[^>]*>([\s\S]*?)<\/div>/i);if(e){const s=e[1];if(s){const x=(await lt(s)).data.match(/\((.*)\)/);if(x&&x[1]){const D=JSON.parse(x[1]);D.data&&D.data.diff.length>0&&(te.value=D.data.diff.map(f=>({code:f.f12,name:f.f14,change:f.f3,changeValue:f.f3/100*f.f2,marketValue:f.f2*f.f9,share:f.f9,market:f.f9/f.f2,position:f.f100})))}}}}},Pe=async()=>{const l=await st(y);if(l&&l.Data_ACWorthTrend&&Array.isArray(l.Data_ACWorthTrend)){const e=l.Data_ACWorthTrend.map(s=>({timestamp:s[0],date:new Date(s[0]),value:s[1],formattedDate:je(new Date(s[0]))}));le.value=e,console.log("处理后的净值数据:",e.length,"条记录"),await pe(),Me()}},je=l=>`${l.getFullYear()}-${(l.getMonth()+1).toString().padStart(2,"0")}-${l.getDate().toString().padStart(2,"0")}`,fe=l=>{const e=new Date,s=[...le.value];if(!s.length||l==="since")return s;let i=new Date;switch(l){case"this_year":i=new Date(e.getFullYear(),0,1);break;case"1m":i.setMonth(e.getMonth()-1);break;case"3m":i.setMonth(e.getMonth()-3);break;case"6m":i.setMonth(e.getMonth()-6);break;case"year":i.setFullYear(e.getFullYear()-1);break;case"3y":i.setFullYear(e.getFullYear()-3);break;case"5y":i.setFullYear(e.getFullYear()-5);break}return s.filter(x=>x.date>=i)},Me=()=>{if(!Z.value)return;h&&h.destroy();const l=fe(E.value);if(!l.length)return;const e=l.map(m=>m.formattedDate),s=l.map(m=>m.value),x=(()=>{if(l.length<2)return"#e30505";const m=l[0].value;return l[l.length-1].value>=m?"#10b981":"#ef4444"})(),f=Z.value.getContext("2d").createLinearGradient(0,0,0,400);f.addColorStop(0,`${x}20`),f.addColorStop(1,`${x}01`),h=new Ge(Z.value,{type:"line",data:{labels:e,datasets:[{label:"单位净值",data:s,borderColor:x,backgroundColor:f,fill:!0,tension:.4,pointRadius:0,pointHoverRadius:4,borderWidth:2,pointBackgroundColor:x}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{mode:"index",intersect:!1,backgroundColor:"rgba(255, 255, 255, 0.95)",titleColor:"#1f2937",bodyColor:"#1f2937",borderColor:"#e5e7eb",borderWidth:1,cornerRadius:6,padding:12,displayColors:!1,callbacks:{title:m=>m[0].label,label:m=>`单位净值: ${m.parsed.y.toFixed(4)}`}}},scales:{x:{grid:{display:!1,drawBorder:!1},ticks:{maxTicksLimit:8,color:"#6b7280",font:{size:11},callback:function(m,S){if(S===0||S===this.getLabels().length-1||S===Math.floor(this.getLabels().length/2))return this.getLabels()[S];const I=new Date(this.getLabels()[S]);return`${I.getMonth()+1}-${I.getDate()}`}}},y:{position:"left",grid:{color:"#f3f4f6",drawBorder:!1},ticks:{color:"#6b7280",font:{size:11},callback:function(m){return m.toFixed(2)},stepSize:function(m){const S=m.chart.data.datasets[0].data,I=Math.max(...S),Ee=Math.min(...S),K=I-Ee;return K<.1?.01:K<.5?.05:K<1?.1:K<5?.5:1}},beginAtZero:!1,min:function(m){const S=m.chart.data.datasets[0].data;return Math.min(...S)*.95},max:function(m){const S=m.chart.data.datasets[0].data;return Math.max(...S)*1.05}}},interaction:{intersect:!1,mode:"index"}}}),console.log("图表初始化完成，数据点数:",l.length)},me=l=>{if(!h||!le.value.length)return;const e=fe(l),s=e.map(f=>f.formattedDate),i=e.map(f=>f.value),D=(()=>{if(e.length<2)return"#10b981";const f=e[0].value;return e[e.length-1].value>=f?"#10b981":"#ef4444"})();if(h.data.labels=s,h.data.datasets[0].data=i,h.data.datasets[0].borderColor=D,h.data.datasets[0].backgroundColor=D+"20",h.data.datasets[0].pointBackgroundColor=D,h.options.scales.y){const f=Math.min(...i)*.95,m=Math.max(...i)*1.05;h.options.scales.y.min=f,h.options.scales.y.max=m}h.update(),console.log("图表更新完成，周期:",l,"数据点数:",e.length)},Ue=async()=>{const l=await at(y),e=ot(l);_.value={type:e.type,hosting:e.hosting,establishDate:e.establishDate,scale:e.scale,manager:e.manager,company:e.company}},$e=()=>{try{const l=JSON.parse(localStorage.getItem("favoriteFunds")||"[]");if(ue.value){const e=l.findIndex(s=>s.code===y);e!==-1&&(l.splice(e,1),localStorage.setItem("favoriteFunds",JSON.stringify(l)),alert("已从自选移除"))}else{const e={code:y,name:r.value.name||_.value.company+"基金",estimateNav:r.value.nav||"1.0000",yesterdayNav:r.value.nav||"1.0000",change:r.value.change||0};l.push(e),localStorage.setItem("favoriteFunds",JSON.stringify(l)),alert("已添加到自选")}}catch(l){console.error("操作自选失败:",l),alert("操作失败，请重试")}},Ie=l=>{E.value=l,me(l)},Oe=l=>{alert(`查看 ${l.name} 板块详情`)},Le=()=>{Y.push({name:"FundHistory",params:{code:y,name:N.name||r.value.name||"基金"}})},b=C(()=>N.value.nav||r.value.nav||1),Je=()=>{const l=k.holdFunds.findIndex(e=>e.code===y);if(l!==-1){const e=k.holdFunds[l];e.holdShare=T.value.holdShare,e.costPrice=T.value.costPrice,e.holdDays=T.value.holdDays,e.holdAmount=e.holdShare*(e.estimateNav||e.nav||b.value),e.holdProfit=(e.estimateNav||e.nav||b.value-e.costPrice)*e.holdShare,r.value={...e},J.value=!1,alert("基金信息修改成功！")}},ze=()=>{const l=k.holdFunds.findIndex(e=>e.code===y);if(l!==-1){const e=k.holdFunds[l];if(!u.value.amount||u.value.amount<=0){alert("请输入加仓金额");return}if(!u.value.buyDate){alert("请选择原平台买入时间");return}const s=se.value,i=u.value.amount-s,x=i/b.value,D=e.holdShare*e.costPrice,f=i,m=e.holdShare+x;e.holdShare=m,e.costPrice=(D+f)/m,e.holdAmount=e.holdShare*(e.estimateNav||e.nav||b.value),e.holdProfit=(e.estimateNav||e.nav||b.value-e.costPrice)*e.holdShare,r.value={...e},u.value={amount:null,fundType:"A",feeRate:.15,buyDate:"",buyTime:"before3"},z.value=!1,alert("加仓成功！")}},Be=()=>{const l=k.holdFunds.findIndex(e=>e.code===y);if(l!==-1){const e=k.holdFunds[l];let s=0;if(n.value.percentage)s=e.holdShare*parseFloat(n.value.percentage);else if(n.value.share&&n.value.share>0)s=n.value.share;else{alert("请选择减仓比例或输入减仓份额");return}if(s>e.holdShare){alert("减仓份额不能超过持有份额！");return}if(!n.value.sellDate){alert("请选择原平台卖出时间");return}if(e.holdShare=e.holdShare-s,e.holdShare<=.01)if(confirm("减仓后将不再持有该基金，是否继续？")){k.holdFunds.splice(l,1),U.value=!1,alert("减仓成功！该基金已从持仓中移除"),Y.back();return}else return;e.holdAmount=e.holdShare*(e.estimateNav||e.nav||b.value),e.holdProfit=(e.estimateNav||e.nav||b.value-e.costPrice)*e.holdShare,r.value={...e},n.value={share:null,percentage:"",fundType:"A",feeRate:.5,sellDate:"",sellTime:"before3"},U.value=!1,alert("减仓成功！")}},We=()=>{if(!d.value.amount||d.value.amount<=0){alert("请输入定投金额");return}const l=JSON.parse(localStorage.getItem("aipPlans")||"[]"),e={code:y,name:N.value.name||r.value.name,amount:d.value.amount,cycle:d.value.cycle,day:d.value.day,createTime:new Date().toISOString(),status:"active"},s=l.findIndex(i=>i.code===y);if(s!==-1)if(confirm("该基金已有定投计划，是否覆盖？"))l[s]=e;else return;else l.push(e);localStorage.setItem("aipPlans",JSON.stringify(l)),d.value={amount:null,cycle:"monthly",day:1},B.value=!1,alert("定投设置成功！")},Ye=()=>{const l=k.holdFunds.findIndex(e=>e.code===y);if(l!==-1){const e=k.holdFunds[l];let s=0;if(o.value.percentage)s=e.holdShare*parseFloat(o.value.percentage);else if(o.value.share&&o.value.share>0)s=o.value.share;else{alert("请选择转换比例或输入转换份额");return}if(s>e.holdShare){alert("转换份额不能超过持有份额！");return}if(!o.value.targetCode){alert("请输入目标基金代码");return}if(!o.value.convertDate){alert("请选择原平台转换时间");return}if(e.holdShare=e.holdShare-s,e.holdShare<=.01)if(confirm("转换后将不再持有该基金，是否继续？")){k.holdFunds.splice(l,1);const i=k.holdFunds.findIndex(x=>x.code===o.value.targetCode);if(i===-1)k.holdFunds.push({code:o.value.targetCode,name:"目标基金",holdShare:s,costPrice:b.value,holdDays:1,estimateNav:b.value,nav:b.value,change:0,holdAmount:s*b.value,holdProfit:0});else{const x=k.holdFunds[i],D=x.holdShare*x.costPrice,f=s*b.value,m=x.holdShare+s;x.holdShare=m,x.costPrice=(D+f)/m}$.value=!1,alert("转换成功！该基金已从持仓中移除，份额已转入目标基金"),Y.back();return}else return;e.holdAmount=e.holdShare*(e.estimateNav||e.nav||b.value),e.holdProfit=(e.estimateNav||e.nav||b.value-e.costPrice)*e.holdShare,r.value={...e},o.value={share:null,percentage:"",fromFundType:"A",toFundType:"A",feeRate:.5,targetCode:"",convertDate:"",convertTime:"before3"},$.value=!1,alert("转换成功！")}};return(l,e)=>(c(),v(P,null,[t("div",rt,[t("header",ut,[t("div",dt,[t("div",it,[t("button",{onClick:e[0]||(e[0]=s=>ne(Y).back()),class:"flex items-center space-x-2 detail-back-btn rounded-full p-2"},[...e[38]||(e[38]=[t("i",{class:"fa fa-arrow-left"},null,-1),t("span",{class:"text-sm font-medium"},"返回",-1)])]),t("div",ct,[t("h2",vt,a(N.value.name||r.value.name),1),t("p",ft,a(ne(y)),1)]),t("button",{onClick:$e,class:"text-white"},[t("i",{class:R(["fa",ue.value?"fa-star":"fa-star-o","text-lg"])},null,2)])])])]),t("main",mt,[ee.value?(c(),v("div",pt,[...e[39]||(e[39]=[t("i",{class:"fa fa-spinner fa-spin text-2xl text-primary"},null,-1),t("p",{class:"mt-2 text-neutral"},"加载中...",-1)])])):(c(),v("div",bt,[t("div",xt,[t("div",gt,[t("div",yt,[e[40]||(e[40]=t("p",{class:"text-neutral text-sm mb-1"},"单位净值",-1)),t("p",ht,a(A(N.value.nav||r.value.nav||0,4)),1)]),t("div",wt,[e[41]||(e[41]=t("p",{class:"text-neutral text-sm mb-1"},"日涨跌幅",-1)),t("p",{class:R(["text-xl font-bold",G(N.value.change||r.value.change||0)])},a(q(N.value.change||r.value.change||0)),3)]),t("div",kt,[e[42]||(e[42]=t("p",{class:"text-neutral text-sm mb-1"},"累计净值",-1)),t("p",Ct,a(A(N.value.accumulatedNav||N.value.nav||r.value.accumulatedNav||r.value.nav||0,4)),1)])]),r.value.holdDays?(c(),v("div",St,[t("div",Dt,[e[43]||(e[43]=t("p",{class:"text-neutral text-sm mb-1"},"持有收益",-1)),t("p",{class:R(["text-lg font-bold",we(r.value.holdProfit||0)])},a(V(r.value.holdProfit||0)),3)]),t("div",Ft,[e[44]||(e[44]=t("p",{class:"text-neutral text-sm mb-1"},"持有金额",-1)),t("p",_t,a(V(r.value.holdAmount||0)),1)]),t("div",Tt,[e[45]||(e[45]=t("p",{class:"text-neutral text-sm mb-1"},"持仓成本",-1)),t("p",At,a(A(r.value.costPrice||0,4)),1)])])):F("",!0)]),t("div",Nt,[e[46]||(e[46]=t("div",{class:"flex items-center justify-between mb-4"},[t("h3",{class:"font-medium"},"净值走势")],-1)),t("div",Vt,[t("div",Rt,[(c(!0),v(P,null,M(ne(Ae),s=>(c(),v("button",{key:s.id,class:R(["time-tab whitespace-nowrap text-sm px-4 py-2 rounded-full transition-colors",E.value===s.id?"tab-active":"tab-inactive"]),onClick:i=>Ie(s.id)},a(s.label),11,Pt))),128))])]),t("div",jt,[t("canvas",{ref_key:"fundChartCanvas",ref:Z},null,512)])]),t("div",Mt,[t("div",Ut,[e[49]||(e[49]=t("h3",{class:"font-medium"},"历史净值",-1)),!H.value&&L.value.length>=10?(c(),v("button",{key:0,onClick:Le,class:"text-primary text-sm hover:text-primary/80 transition-colors"},[...e[47]||(e[47]=[Q(" 查看更多 ",-1),t("i",{class:"fa fa-chevron-right ml-1"},null,-1)])])):H.value?(c(),v("button",{key:1,onClick:e[1]||(e[1]=s=>H.value=!1),class:"text-primary text-sm hover:text-primary/80 transition-colors"},[...e[48]||(e[48]=[Q(" 收起 ",-1),t("i",{class:"fa fa-chevron-up ml-1"},null,-1)])])):F("",!0)]),t("div",$t,[t("table",It,[e[51]||(e[51]=t("thead",null,[t("tr",{class:"border-b border-gray-100"},[t("th",{class:"text-left py-3 px-2 text-sm font-medium text-neutral"},"日期"),t("th",{class:"text-left py-3 px-2 text-sm font-medium text-neutral"},"单位净值"),t("th",{class:"text-left py-3 px-2 text-sm font-medium text-neutral"},"累计净值"),t("th",{class:"text-left py-3 px-2 text-sm font-medium text-neutral"},"日涨跌幅")])],-1)),t("tbody",null,[(c(!0),v(P,null,M(he.value,s=>(c(),v("tr",{key:s.date,class:"border-b border-gray-50 hover:bg-gray-50"},[t("td",Ot,a(s.date),1),t("td",Lt,a(s.nav),1),t("td",Jt,a(s.accumulatedNav),1),t("td",zt,[t("span",{class:R(["text-sm font-medium",G(s.change)])},a(q(s.change)),3)])]))),128)),L.value.length===0?(c(),v("tr",Bt,[...e[50]||(e[50]=[t("td",{colspan:"4",class:"py-8 text-center text-neutral"},[t("i",{class:"fa fa-exclamation-circle text-2xl mb-2"}),t("p",null,"暂无历史数据")],-1)])])):F("",!0)])])])]),ve.value.length>0?(c(),v("div",Wt,[e[52]||(e[52]=t("h3",{class:"font-medium mb-4"},"关联板块",-1)),t("div",Yt,[(c(!0),v(P,null,M(ve.value,s=>(c(),v("span",{key:s.name,onClick:i=>Oe(s),class:"px-3 py-1.5 bg-gray-100 text-neutral rounded-full text-sm hover:bg-gray-200 transition-colors cursor-pointer"},[Q(a(s.name)+" ",1),t("span",{class:R(["ml-1 text-xs font-medium",G(s.change)])},a(q(s.change)),3)],8,Et))),128))])])):F("",!0),te.value.length>0?(c(),v("div",Ht,[e[54]||(e[54]=t("h3",{class:"font-medium mb-4"},"基金重仓股",-1)),t("div",Zt,[(c(!0),v(P,null,M(te.value,s=>(c(),v("div",{key:s.code,class:"flex items-center p-3 border border-gray-100 rounded-lg hover:bg-gray-50 transition-colors"},[t("div",qt,[t("div",Gt,[t("h4",Kt,a(s.name),1),t("span",{class:R(["text-sm font-medium",G(s.change)])}," 涨跌幅: "+a(q(s.change)),3)]),t("div",Qt,[t("span",Xt,a(s.code),1),t("span",el,[e[53]||(e[53]=Q("所属板块: ",-1)),t("span",tl,a(s.position),1)])])])]))),128))])])):F("",!0),t("div",ll,[e[61]||(e[61]=t("h3",{class:"font-medium mb-4"},"基金信息",-1)),t("div",sl,[t("div",al,[e[55]||(e[55]=t("span",{class:"text-neutral"},"基金类型",-1)),t("span",ol,a(_.value.type||"--"),1)]),t("div",nl,[e[56]||(e[56]=t("span",{class:"text-neutral"},"基金托管",-1)),t("span",rl,a(_.value.hosting||"--"),1)]),t("div",ul,[e[57]||(e[57]=t("span",{class:"text-neutral"},"成立时间",-1)),t("span",dl,a(_.value.establishDate?_.value.establishDate.split("/")[0]:"--"),1)]),t("div",il,[e[58]||(e[58]=t("span",{class:"text-neutral"},"基金规模",-1)),t("span",cl,a(_.value.scale?_.value.scale.split("（")[0]:"--"),1)]),t("div",vl,[e[59]||(e[59]=t("span",{class:"text-neutral"},"基金经理",-1)),t("span",fl,a(_.value.manager||"--"),1)]),t("div",ml,[e[60]||(e[60]=t("span",{class:"text-neutral"},"基金公司",-1)),t("span",pl,a(_.value.company||"--"),1)])])]),r.value.holdDays?(c(),v("div",bl,[t("div",xl,[t("div",gl,[t("button",{onClick:e[2]||(e[2]=s=>J.value=!0),class:"flex flex-col items-center justify-center p-3 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors"},[...e[62]||(e[62]=[t("i",{class:"fa fa-edit text-blue-600 text-lg mb-1"},null,-1),t("span",{class:"text-xs font-medium text-blue-700"},"修改",-1)])]),t("button",{onClick:e[3]||(e[3]=s=>z.value=!0),class:"flex flex-col items-center justify-center p-3 bg-green-50 hover:bg-green-100 rounded-lg transition-colors"},[...e[63]||(e[63]=[t("i",{class:"fa fa-plus-circle text-green-600 text-lg mb-1"},null,-1),t("span",{class:"text-xs font-medium text-green-700"},"加仓",-1)])]),t("button",{onClick:e[4]||(e[4]=s=>U.value=!0),class:"flex flex-col items-center justify-center p-3 bg-orange-50 hover:bg-orange-100 rounded-lg transition-colors"},[...e[64]||(e[64]=[t("i",{class:"fa fa-minus-circle text-orange-600 text-lg mb-1"},null,-1),t("span",{class:"text-xs font-medium text-orange-700"},"减仓",-1)])]),t("button",{onClick:e[5]||(e[5]=s=>B.value=!0),class:"flex flex-col items-center justify-center p-3 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors"},[...e[65]||(e[65]=[t("i",{class:"fa fa-calendar-check-o text-purple-600 text-lg mb-1"},null,-1),t("span",{class:"text-xs font-medium text-purple-700"},"定投",-1)])]),t("button",{onClick:e[6]||(e[6]=s=>$.value=!0),class:"flex flex-col items-center justify-center p-3 bg-indigo-50 hover:bg-indigo-100 rounded-lg transition-colors"},[...e[66]||(e[66]=[t("i",{class:"fa fa-exchange text-indigo-600 text-lg mb-1"},null,-1),t("span",{class:"text-xs font-medium text-indigo-700"},"转换",-1)])])])])])):F("",!0)])),r.value.holdDays?(c(),v("div",yl)):F("",!0)])]),J.value?(c(),v("div",hl,[t("div",wl,[e[70]||(e[70]=t("h3",{class:"text-lg font-bold mb-4"},"修改基金信息",-1)),t("div",kl,[t("div",null,[e[67]||(e[67]=t("label",{class:"block text-sm text-neutral mb-2"},"持有份额",-1)),p(t("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>T.value.holdShare=s),type:"number",step:"0.01",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[w,T.value.holdShare,void 0,{number:!0}]])]),t("div",null,[e[68]||(e[68]=t("label",{class:"block text-sm text-neutral mb-2"},"持仓成本",-1)),p(t("input",{"onUpdate:modelValue":e[8]||(e[8]=s=>T.value.costPrice=s),type:"number",step:"0.0001",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[w,T.value.costPrice,void 0,{number:!0}]])]),t("div",null,[e[69]||(e[69]=t("label",{class:"block text-sm text-neutral mb-2"},"持有天数",-1)),p(t("input",{"onUpdate:modelValue":e[9]||(e[9]=s=>T.value.holdDays=s),type:"number",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[w,T.value.holdDays,void 0,{number:!0}]])])]),t("div",Cl,[t("button",{onClick:e[10]||(e[10]=s=>J.value=!1),class:"flex-1 py-2 border border-gray-300 rounded-lg font-medium"},"取消"),t("button",{onClick:Je,class:"flex-1 py-2 bg-blue-600 text-white rounded-lg font-medium"},"确认修改")])])])):F("",!0),z.value?(c(),v("div",Sl,[t("div",Dl,[e[84]||(e[84]=t("h3",{class:"text-lg font-bold mb-4"},"同步加仓",-1)),t("div",Fl,[t("div",null,[e[71]||(e[71]=t("label",{class:"block text-sm text-neutral mb-2"},"加仓金额",-1)),p(t("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>u.value.amount=s),type:"number",step:"0.01",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"请输入加仓金额"},null,512),[[w,u.value.amount,void 0,{number:!0}]]),t("p",_l,"当前净值: "+a(A(b.value,4))+"元",1)]),t("div",null,[e[73]||(e[73]=t("label",{class:"block text-sm text-neutral mb-2"},"基金类型",-1)),p(t("select",{"onUpdate:modelValue":e[12]||(e[12]=s=>u.value.fundType=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},[...e[72]||(e[72]=[t("option",{value:"A"},"A类基金",-1),t("option",{value:"C"},"C类基金",-1)])],512),[[W,u.value.fundType]]),t("p",Tl,a(u.value.fundType==="A"?"A类基金：申购费0.1%-1.5%，无销售服务费":"C类基金：无申购费，销售服务费0.2%-0.8%/年"),1)]),t("div",null,[e[75]||(e[75]=t("label",{class:"block text-sm text-neutral mb-2"},"买入费率",-1)),t("div",Al,[p(t("input",{"onUpdate:modelValue":e[13]||(e[13]=s=>u.value.feeRate=s),type:"number",step:"0.001",min:"0",max:"5",class:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"费率%"},null,512),[[w,u.value.feeRate,void 0,{number:!0}]]),e[74]||(e[74]=t("span",{class:"px-3 py-2 text-gray-600"},"%",-1))]),t("p",Nl,a(u.value.fundType==="A"?"建议：0.1%-1.5%":"建议：0%"),1)]),t("div",Vl,[t("div",Rl,[e[76]||(e[76]=t("span",{class:"text-neutral"},"估算份额:",-1)),t("span",Pl,a(ke.value)+"份",1)]),t("div",jl,[e[77]||(e[77]=t("span",{class:"text-neutral"},"估算手续费:",-1)),t("span",Ml,a(V(se.value)),1)]),t("div",Ul,[e[78]||(e[78]=t("span",null,"实际支付:",-1)),t("span",$l,a(V(u.value.amount||0)),1)]),e[79]||(e[79]=t("p",{class:"text-xs text-gray-500 mt-2"},"* 手续费已从加仓金额中扣除",-1))]),t("div",null,[e[80]||(e[80]=t("label",{class:"block text-sm text-neutral mb-2"},"原平台买入时间",-1)),p(t("input",{"onUpdate:modelValue":e[14]||(e[14]=s=>u.value.buyDate=s),type:"date",max:ae.value,min:oe.value,class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},null,8,Il),[[w,u.value.buyDate]])]),t("div",null,[e[83]||(e[83]=t("label",{class:"block text-sm text-neutral mb-2"},"买入时间",-1)),t("div",Ol,[t("label",Ll,[p(t("input",{"onUpdate:modelValue":e[15]||(e[15]=s=>u.value.buyTime=s),type:"radio",value:"before3",class:"mr-2"},null,512),[[O,u.value.buyTime]]),e[81]||(e[81]=t("span",{class:"text-sm"},"下午3点前",-1))]),t("label",Jl,[p(t("input",{"onUpdate:modelValue":e[16]||(e[16]=s=>u.value.buyTime=s),type:"radio",value:"after3",class:"mr-2"},null,512),[[O,u.value.buyTime]]),e[82]||(e[82]=t("span",{class:"text-sm"},"下午3点后",-1))])]),t("p",zl,a(u.value.buyTime==="before3"?"按今日净值计算":"按明日净值计算"),1)])]),t("div",Bl,[t("button",{onClick:e[17]||(e[17]=s=>z.value=!1),class:"flex-1 py-2 border border-gray-300 rounded-lg font-medium"},"取消"),t("button",{onClick:ze,class:"flex-1 py-2 bg-green-600 text-white rounded-lg font-medium"},"确认加仓")])])])):F("",!0),U.value?(c(),v("div",Wl,[t("div",Yl,[e[97]||(e[97]=t("h3",{class:"text-lg font-bold mb-4"},"同步减仓",-1)),t("div",El,[t("div",null,[t("label",Hl,"当前持有: "+a(A(r.value.holdShare||0,2))+"份",1),p(t("input",{"onUpdate:modelValue":e[18]||(e[18]=s=>n.value.share=s),type:"number",step:"0.01",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"请输入减仓份额"},null,512),[[w,n.value.share,void 0,{number:!0}]])]),t("div",null,[e[85]||(e[85]=t("label",{class:"block text-sm text-neutral mb-2"},"快速选择减仓比例",-1)),t("div",Zl,[(c(),v(P,null,M(be,s=>t("button",{key:s.value,onClick:i=>xe(s),class:R(["py-2 px-2 text-sm rounded-lg border transition-colors",n.value.percentage===s.value?"bg-orange-100 border-orange-300 text-orange-700":"bg-white border-gray-300 hover:bg-gray-50"])},a(s.label),11,ql)),64))])]),t("div",null,[e[87]||(e[87]=t("label",{class:"block text-sm text-neutral mb-2"},"基金类型",-1)),p(t("select",{"onUpdate:modelValue":e[19]||(e[19]=s=>n.value.fundType=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},[...e[86]||(e[86]=[t("option",{value:"A"},"A类基金",-1),t("option",{value:"C"},"C类基金",-1)])],512),[[W,n.value.fundType]]),t("p",Gl,a(n.value.fundType==="A"?"A类基金：持有<7天1.5%，1年以内0.5%，1-2年0.25%，2年以上0%":"C类基金：持有<7天1.5%，30天以内0.5%，30天以上0%"),1)]),t("div",null,[e[89]||(e[89]=t("label",{class:"block text-sm text-neutral mb-2"},"赎回费率",-1)),t("div",Kl,[p(t("input",{"onUpdate:modelValue":e[20]||(e[20]=s=>n.value.feeRate=s),type:"number",step:"0.001",min:"0",max:"5",class:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"费率%"},null,512),[[w,n.value.feeRate,void 0,{number:!0}]]),e[88]||(e[88]=t("span",{class:"px-3 py-2 text-gray-600"},"%",-1))]),t("p",Ql,a(n.value.fundType==="A"?"建议：根据持有时间0%-1.5%":"建议：持有30天以上0%"),1)]),t("div",Xl,[t("div",es,[e[90]||(e[90]=t("span",{class:"text-neutral"},"减仓份额:",-1)),t("span",ts,a(A(n.value.share||0,2))+"份",1)]),t("div",ls,[e[91]||(e[91]=t("span",{class:"text-neutral"},"估算手续费:",-1)),t("span",ss,a(V(de.value)),1)]),t("div",as,[e[92]||(e[92]=t("span",null,"预计到账:",-1)),t("span",os,a(V(Ce.value)),1)])]),t("div",null,[e[93]||(e[93]=t("label",{class:"block text-sm text-neutral mb-2"},"原平台卖出时间",-1)),p(t("input",{"onUpdate:modelValue":e[21]||(e[21]=s=>n.value.sellDate=s),type:"date",max:ae.value,min:oe.value,class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},null,8,ns),[[w,n.value.sellDate]])]),t("div",null,[e[96]||(e[96]=t("label",{class:"block text-sm text-neutral mb-2"},"卖出时间",-1)),t("div",rs,[t("label",us,[p(t("input",{"onUpdate:modelValue":e[22]||(e[22]=s=>n.value.sellTime=s),type:"radio",value:"before3",class:"mr-2"},null,512),[[O,n.value.sellTime]]),e[94]||(e[94]=t("span",{class:"text-sm"},"下午3点前",-1))]),t("label",ds,[p(t("input",{"onUpdate:modelValue":e[23]||(e[23]=s=>n.value.sellTime=s),type:"radio",value:"after3",class:"mr-2"},null,512),[[O,n.value.sellTime]]),e[95]||(e[95]=t("span",{class:"text-sm"},"下午3点后",-1))])]),t("p",is,a(n.value.sellTime==="before3"?"按今日净值计算":"按明日净值计算"),1)])]),t("div",cs,[t("button",{onClick:e[24]||(e[24]=s=>U.value=!1),class:"flex-1 py-2 border border-gray-300 rounded-lg font-medium"},"取消"),t("button",{onClick:Be,class:"flex-1 py-2 bg-orange-600 text-white rounded-lg font-medium"},"确认减仓")])])])):F("",!0),B.value?(c(),v("div",vs,[t("div",fs,[e[110]||(e[110]=t("h3",{class:"text-lg font-bold mb-4"},"同步定投",-1)),t("div",ms,[t("div",null,[e[98]||(e[98]=t("label",{class:"block text-sm text-neutral mb-2"},"定投金额",-1)),p(t("input",{"onUpdate:modelValue":e[25]||(e[25]=s=>d.value.amount=s),type:"number",step:"0.01",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"请输入每次定投金额"},null,512),[[w,d.value.amount,void 0,{number:!0}]])]),t("div",null,[e[100]||(e[100]=t("label",{class:"block text-sm text-neutral mb-2"},"基金类型",-1)),p(t("select",{"onUpdate:modelValue":e[26]||(e[26]=s=>d.value.fundType=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},[...e[99]||(e[99]=[t("option",{value:"A"},"A类基金",-1),t("option",{value:"C"},"C类基金",-1)])],512),[[W,d.value.fundType]]),t("p",ps,a(d.value.fundType==="A"?"A类基金：申购费0.1%-1.5%，无销售服务费":"C类基金：无申购费，销售服务费0.2%-0.8%/年"),1)]),t("div",null,[e[102]||(e[102]=t("label",{class:"block text-sm text-neutral mb-2"},"买入费率",-1)),t("div",bs,[p(t("input",{"onUpdate:modelValue":e[27]||(e[27]=s=>d.value.feeRate=s),type:"number",step:"0.001",min:"0",max:"5",class:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"费率%"},null,512),[[w,d.value.feeRate,void 0,{number:!0}]]),e[101]||(e[101]=t("span",{class:"px-3 py-2 text-gray-600"},"%",-1))]),t("p",xs,a(d.value.fundType==="A"?"建议：0.1%-1.5%":"建议：0%"),1)]),t("div",gs,[t("div",ys,[t("div",hs,[e[103]||(e[103]=t("span",{class:"text-neutral"},"估算份额:",-1)),t("span",ws,a(Te.value)+"份",1)]),t("div",ks,[e[104]||(e[104]=t("span",{class:"text-neutral"},"估算手续费:",-1)),t("span",Cs,a(V(ce.value)),1)])])]),t("div",Ss,[e[109]||(e[109]=t("label",{class:"block text-sm text-neutral"},"定投设置",-1)),t("div",Ds,[t("div",Fs,[e[106]||(e[106]=t("label",{class:"block text-xs text-gray-500 mb-1"},"定投周期",-1)),p(t("select",{"onUpdate:modelValue":e[28]||(e[28]=s=>d.value.cycle=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 appearance-none bg-white"},[...e[105]||(e[105]=[Ke('<option value="" data-v-ed46f4e8>选择周期</option><option value="daily" data-v-ed46f4e8>每日</option><option value="weekly" data-v-ed46f4e8>每周</option><option value="biweekly" data-v-ed46f4e8>每两周</option><option value="monthly" data-v-ed46f4e8>每月</option>',5)])],512),[[W,d.value.cycle]]),e[107]||(e[107]=t("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[t("i",{class:"fa fa-chevron-down text-xs"})],-1))]),d.value.cycle?(c(),v("div",_s,[t("label",Ts,a(Fe()),1),p(t("select",{"onUpdate:modelValue":e[29]||(e[29]=s=>d.value.day=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 appearance-none bg-white"},[(c(!0),v(P,null,M(_e(),s=>(c(),v("option",{key:s.value,value:s.value},a(s.label),9,As))),128))],512),[[W,d.value.day]]),e[108]||(e[108]=t("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[t("i",{class:"fa fa-chevron-down text-xs"})],-1))])):(c(),v("div",Ns))])])]),t("div",Vs,[t("button",{onClick:e[30]||(e[30]=s=>B.value=!1),class:"flex-1 py-2 border border-gray-300 rounded-lg font-medium"},"取消"),t("button",{onClick:We,class:"flex-1 py-2 bg-purple-600 text-white rounded-lg font-medium"},"设置定投")])])])):F("",!0),$.value?(c(),v("div",Rs,[t("div",Ps,[e[123]||(e[123]=t("h3",{class:"text-lg font-bold mb-4"},"基金转换",-1)),t("div",js,[t("div",null,[t("label",Ms,"当前持有: "+a(A(r.value.holdShare||0,2))+"份",1),p(t("input",{"onUpdate:modelValue":e[31]||(e[31]=s=>o.value.share=s),type:"number",step:"0.01",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"请输入转换份额"},null,512),[[w,o.value.share,void 0,{number:!0}]])]),t("div",null,[e[111]||(e[111]=t("label",{class:"block text-sm text-neutral mb-2"},"快速选择转换比例",-1)),t("div",Us,[(c(),v(P,null,M(ge,s=>t("button",{key:s.value,onClick:i=>ye(s),class:R(["py-2 px-2 text-sm rounded-lg border transition-colors",o.value.percentage===s.value?"bg-indigo-100 border-indigo-300 text-indigo-700":"bg-white border-gray-300 hover:bg-gray-50"])},a(s.label),11,$s)),64))])]),t("div",null,[e[113]||(e[113]=t("label",{class:"block text-sm text-neutral mb-2"},"转换费率",-1)),t("div",Is,[p(t("input",{"onUpdate:modelValue":e[32]||(e[32]=s=>o.value.feeRate=s),type:"number",step:"0.001",min:"0",max:"5",class:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"费率%"},null,512),[[w,o.value.feeRate,void 0,{number:!0}]]),e[112]||(e[112]=t("span",{class:"px-3 py-2 text-gray-600"},"%",-1))]),e[114]||(e[114]=t("p",{class:"text-xs text-gray-500 mt-1"},"建议：补差申购费或赎回费的较低者",-1))]),t("div",Os,[t("div",Ls,[e[115]||(e[115]=t("span",{class:"text-neutral"},"转换份额:",-1)),t("span",Js,a(A(o.value.share||0,2))+"份",1)]),t("div",zs,[e[116]||(e[116]=t("span",{class:"text-neutral"},"估算手续费:",-1)),t("span",Bs,a(V(ie.value)),1)]),t("div",Ws,[e[117]||(e[117]=t("span",null,"预计转入价值:",-1)),t("span",Ys,a(V(Se.value)),1)])]),t("div",null,[e[118]||(e[118]=t("label",{class:"block text-sm text-neutral mb-2"},"目标基金代码",-1)),p(t("input",{"onUpdate:modelValue":e[33]||(e[33]=s=>o.value.targetCode=s),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"请输入目标基金代码"},null,512),[[w,o.value.targetCode]])]),t("div",null,[e[119]||(e[119]=t("label",{class:"block text-sm text-neutral mb-2"},"原平台转换时间",-1)),p(t("input",{"onUpdate:modelValue":e[34]||(e[34]=s=>o.value.convertDate=s),type:"date",max:ae.value,min:oe.value,class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},null,8,Es),[[w,o.value.convertDate]])]),t("div",null,[e[122]||(e[122]=t("label",{class:"block text-sm text-neutral mb-2"},"转换时间",-1)),t("div",Hs,[t("label",Zs,[p(t("input",{"onUpdate:modelValue":e[35]||(e[35]=s=>o.value.convertTime=s),type:"radio",value:"before3",class:"mr-2"},null,512),[[O,o.value.convertTime]]),e[120]||(e[120]=t("span",{class:"text-sm"},"下午3点前",-1))]),t("label",qs,[p(t("input",{"onUpdate:modelValue":e[36]||(e[36]=s=>o.value.convertTime=s),type:"radio",value:"after3",class:"mr-2"},null,512),[[O,o.value.convertTime]]),e[121]||(e[121]=t("span",{class:"text-sm"},"下午3点后",-1))])]),t("p",Gs,a(o.value.convertTime==="before3"?"按今日净值计算":"按明日净值计算"),1)])]),t("div",Ks,[t("button",{onClick:e[37]||(e[37]=s=>$.value=!1),class:"flex-1 py-2 border border-gray-300 rounded-lg font-medium"},"取消"),t("button",{onClick:Ye,class:"flex-1 py-2 bg-indigo-600 text-white rounded-lg font-medium"},"确认转换")])])])):F("",!0)],64))}},oa=He(Qs,[["__scopeId","data-v-ed46f4e8"]]);export{oa as default};
