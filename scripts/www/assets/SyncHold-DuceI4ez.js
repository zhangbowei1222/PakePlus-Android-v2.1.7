import{_ as B,w as M,b as a,c as n,d as t,n as p,f as d,k as g,v as b,t as m,F as S,r as U,h as i,j as V}from"./index-CRAB7jjQ.js";import{u as j}from"./fundStore-B47IS5EL.js";import{f as I,s as $}from"./data-DyJSRnoA.js";import"./jsonpCallbackGenerator-Bt3BN9dH.js";const z={class:"page-content page-transition"},L={class:"bg-white rounded-xl p-5 card-shadow"},T={class:"flex border-b border-gray-200 mb-4"},G={key:0,class:"upload-panel"},H={key:0,class:"upload-preview mb-4"},J=["src"],Y={key:1,class:"manual-panel"},q={class:"space-y-4 mb-4"},Q={class:"input-group"},W={key:0,class:"mt-1 text-xs text-red-600"},X={key:1,class:"mt-2 bg-white border border-gray-200 rounded-lg max-h-60 overflow-y-auto"},Z=["onClick"],K={class:"flex justify-between items-center"},ee={class:"text-sm font-medium text-gray-900"},te={class:"text-xs text-gray-500"},oe={class:"text-xs text-gray-400"},re={class:"input-group"},le={key:0,class:"mt-1 text-xs text-red-600"},se={class:"input-group"},ae={key:0,class:"mt-1 text-xs text-red-600"},ne={class:"input-group"},ue={key:0,class:"mt-1 text-xs text-red-600"},de={__name:"SyncHold",setup(ie){const _=V();j();const A=()=>{_.go(-1)},c=i("upload"),v=i(null),x=i(""),f=i(null),C=()=>{v.value.click()},P=r=>{const e=r.target.files[0];if(e){if(e.size>5*1024*1024){alert("文件大小不能超过5MB"),v.value.value="",f.value=null;return}f.value=e;const o=new FileReader;o.onload=h=>{x.value=h.target.result},o.readAsDataURL(e)}},N=async()=>{if(!f.value){alert("请先上传图片");return}try{const e=await(h=>new Promise((E,O)=>{const k=new FileReader;k.readAsDataURL(h),k.onload=()=>{const w=k.result.split(",")[1];E(w)},k.onerror=w=>O(w)}))(f.value),o=await I(e);console.log("OCR识别结果：",o),o&&o.data?alert(`OCR识别成功！识别结果：${JSON.stringify(o.data)}`):alert("OCR识别失败，请检查图片清晰度")}catch(r){console.error("OCR识别失败:",r),alert("识别失败："+r.message)}},l=i({name:"",code:"",holdAmount:"",holdProfit:"",holdDays:""}),s=i({name:"",holdAmount:"",holdProfit:"",holdDays:""}),y=i(""),u=i([]);M(y,async r=>{if(console.log("newKeyword:",r),console.log("searchResults:",u),r&&r.trim().length>=2)try{const e=await $(r.trim());e.data&&e.data.Datas?u.value=e.data.Datas:u.value=[]}catch(e){console.error("搜索基金失败:",e),u.value=[]}else u.value=[]});const F=r=>{l.value.name=r.NAME,l.value.code=r.CODE,y.value=r.NAME,u.value=[]},D=()=>{l.value={name:"",code:"",holdAmount:"",holdProfit:"",holdDays:""},y.value="",u.value=[]},R=async()=>{s.value={name:"",holdAmount:"",holdProfit:"",holdDays:""};let r=!1;l.value.name||(s.value.name="请输入基金名称",r=!0),(!l.value.holdAmount||isNaN(l.value.holdAmount)||Number(l.value.holdAmount)<=0)&&(s.value.holdAmount="请输入有效的持有金额",r=!0),(l.value.holdProfit===""||isNaN(l.value.holdProfit))&&(s.value.holdProfit="请输入有效的持有收益",r=!0),(!l.value.holdDays||isNaN(l.value.holdDays)||l.value.holdDays<=0)&&(s.value.holdDays="请输入有效的持有天数",r=!0),!r&&(D(),f.value=null,x.value="",v.value&&(v.value.value=""))};return(r,e)=>(a(),n("div",z,[t("div",{class:"flex items-center justify-between mb-6"},[t("button",{onClick:A,class:"text-gray-600 flex items-center"},[...e[7]||(e[7]=[t("i",{class:"fa fa-arrow-left mr-2"},null,-1),t("span",{class:"text-sm"},"返回",-1)])]),e[8]||(e[8]=t("h1",{class:"text-xl font-bold"},"同步持仓",-1)),e[9]||(e[9]=t("div",{class:"w-8"},null,-1))]),t("div",L,[t("div",T,[t("button",{onClick:e[0]||(e[0]=o=>c.value="upload"),class:p(["py-2 px-4 text-sm font-medium border-b-2 transition-colors",c.value==="upload"?"text-primary border-primary":"text-gray-500 border-transparent"])}," 截图上传 ",2),t("button",{onClick:e[1]||(e[1]=o=>c.value="manual"),class:p(["py-2 px-4 text-sm font-medium border-b-2 transition-colors",c.value==="manual"?"text-primary border-primary":"text-gray-500 border-transparent"])}," 手动输入 ",2)]),c.value==="upload"?(a(),n("div",G,[t("div",{onClick:C,class:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center cursor-pointer hover:border-primary transition-colors mb-4"},[e[10]||(e[10]=t("i",{class:"fa fa-cloud-upload text-3xl text-gray-400 mb-2"},null,-1)),e[11]||(e[11]=t("p",{class:"text-gray-500 text-sm"},"点击上传持仓页截图",-1)),e[12]||(e[12]=t("p",{class:"text-gray-400 text-xs mt-1"},"支持JPG/PNG格式，最大5MB",-1)),t("input",{ref_key:"fileInput",ref:v,type:"file",accept:"image/jpeg,image/png",class:"hidden",onChange:P},null,544)]),x.value?(a(),n("div",H,[e[13]||(e[13]=t("p",{class:"text-sm text-gray-600 mb-2"},"预览:",-1)),t("img",{src:x.value,class:"rounded-lg w-full h-auto max-h-60 object-contain",alt:"持仓截图"},null,8,J)])):d("",!0),t("button",{onClick:N,class:"w-full bg-primary text-white py-2 rounded-lg text-sm font-medium hover:bg-primary/90 transition-colors"}," 识别并同步 ")])):d("",!0),c.value==="manual"?(a(),n("div",Y,[t("div",q,[t("div",Q,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"基金名称/代码",-1)),g(t("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>y.value=o),type:"text",class:p(["w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-1 focus:border-primary",s.value.name?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-primary"]),placeholder:"请输入基金名称或代码搜索"},null,2),[[b,y.value]]),s.value.name?(a(),n("p",W,m(s.value.name),1)):d("",!0),u.value.length>0?(a(),n("div",X,[(a(!0),n(S,null,U(u.value,o=>(a(),n("div",{key:o.CODE,onClick:h=>F(o),class:"px-3 py-2 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0"},[t("div",K,[t("div",null,[t("div",ee,m(o.NAME),1),t("div",te,m(o.CODE),1)]),t("div",oe,m(o.TYPE),1)])],8,Z))),128))])):d("",!0),g(t("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>l.value.name=o),type:"hidden"},null,512),[[b,l.value.name]])]),t("div",re,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"持有金额 (元)",-1)),g(t("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>l.value.holdAmount=o),type:"number",step:"0.01",class:p(["w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-1 focus:border-primary",s.value.holdAmount?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-primary"]),placeholder:"请输入持有金额"},null,2),[[b,l.value.holdAmount]]),s.value.holdAmount?(a(),n("p",le,m(s.value.holdAmount),1)):d("",!0)]),t("div",se,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"持有收益 (元)",-1)),g(t("input",{"onUpdate:modelValue":e[5]||(e[5]=o=>l.value.holdProfit=o),type:"number",step:"0.01",class:p(["w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-1 focus:border-primary",s.value.holdProfit?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-primary"]),placeholder:"请输入持有收益"},null,2),[[b,l.value.holdProfit]]),s.value.holdProfit?(a(),n("p",ae,m(s.value.holdProfit),1)):d("",!0)]),t("div",ne,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"持有天数 (天)",-1)),g(t("input",{"onUpdate:modelValue":e[6]||(e[6]=o=>l.value.holdDays=o),type:"number",class:p(["w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-1 focus:border-primary",s.value.holdDays?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-primary"]),placeholder:"请输入持有天数"},null,2),[[b,l.value.holdDays]]),s.value.holdDays?(a(),n("p",ue,m(s.value.holdDays),1)):d("",!0)])]),t("div",{class:"flex space-x-3"},[t("button",{onClick:R,class:"flex-1 bg-primary text-white py-2 rounded-lg text-sm font-medium hover:bg-primary/90 transition-colors"}," 添加持仓 "),t("button",{onClick:D,class:"flex-1 bg-gray-100 text-gray-700 py-2 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors"}," 重置 ")])])):d("",!0)])]))}},fe=B(de,[["__scopeId","data-v-40fadd66"]]);export{fe as default};
