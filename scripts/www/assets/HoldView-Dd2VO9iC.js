import{_ as z,o as U,a as G,b as g,c as b,d as e,t as o,e as J,n as l,u as c,f as S,F as K,r as O,g as Q,h as n,i as v,j as W}from"./index-CRAB7jjQ.js";import{u as X}from"./fundStore-B47IS5EL.js";import{g as w,a as A}from"./format-DZ_smWHi.js";import{g as Y}from"./data-DyJSRnoA.js";import"./jsonpCallbackGenerator-Bt3BN9dH.js";const Z={class:"page-content page-transition"},ee={class:"mb-6"},te={class:"flex items-center justify-between mb-3"},se={class:"text-xs px-3 py-1 rounded-full bg-blue-50 text-blue-600 font-medium"},ae={class:"bg-white rounded-xl p-5 card-shadow mb-6"},oe={class:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-2"},le={class:"bg-gradient-to-br from-blue-50 to-sky-50 rounded-lg p-4 border border-blue-100"},ne={class:"flex items-center justify-between mb-1"},re={class:"text-base font-bold text-blue-600"},ie={class:"bg-gradient-to-br from-emerald-50 to-green-50 rounded-lg p-4 border border-green-100"},de={class:"flex items-center justify-between mb-1"},ue={class:"bg-gradient-to-br from-violet-50 to-purple-50 rounded-lg p-4 border border-purple-100"},ce={class:"bg-gradient-to-br from-amber-50 to-yellow-50 rounded-lg p-4 border border-amber-100"},ve={class:"bg-white rounded-xl p-5 card-shadow mb-6"},me={key:0,class:"bg-amber-50 border border-amber-200 rounded-lg p-3 mb-4"},fe={class:"flex items-center text-amber-700 text-sm"},ge={key:1,class:"bg-green-50 border border-green-200 rounded-lg p-3 mb-4"},be={class:"flex items-center text-green-700 text-sm"},xe={class:"space-y-3"},pe=["onClick"],he={class:"flex justify-between items-center mb-1"},ye={class:"flex flex-col"},_e={class:"font-medium"},we={class:"text-xs text-gray-500 mt-1"},Te={class:"grid grid-cols-2 gap-2 text-sm mt-2"},Pe={class:"flex justify-between"},ke={class:"flex justify-between"},Ce={class:"flex justify-between"},Fe={class:"font-medium"},De={class:"flex justify-between"},je={class:"font-medium"},Se={class:"w-full h-1.5 bg-gray-100 rounded-full mt-2"},M=20,Ae={__name:"HoldView",setup(Me){const C=W(),$=X(),x=n(!0),p=n(!0),F=n(0),h=n(0),i=n(null),y=n(!1),m=n(!1),T=n("数据刷新成功"),r=n(null),d=v(()=>$.holdFunds),I=v(()=>{const s=new Date;return`${s.getMonth()+1}月${s.getDate()}日 星期${["日","一","二","三","四","五","六"][s.getDay()]}`}),D=v(()=>d.value.reduce((s,t)=>s+t.holdAmount,0)),P=v(()=>d.value.reduce((s,t)=>s+t.dayProfit,0)),f=v(()=>d.value.reduce((s,t)=>s+t.holdProfit,0)),k=v(()=>{const s=D.value;return s===0?0:f.value/(s-f.value)*100}),u=s=>s==null?"0.00":Number(s).toFixed(2),R=s=>{const t=parseFloat(s);return t>=0?Math.ceil(t*100)/100:Math.floor(t*100)/100},V=s=>{const t=R(parseFloat(s));return t>=0?`+${t.toFixed(2)}`:`${t.toFixed(2)}`},H=s=>{C.push({name:"FundDetail",params:{code:s.code}})},N=()=>{const s=Date.now(),t=(s-F.value)/1e3;if(t<M){const a=Math.ceil(M-t);h.value=a,y.value=!0,i.value&&clearInterval(i.value),i.value=setInterval(()=>{h.value--,h.value<=0&&(clearInterval(i.value),i.value=null,y.value=!1)},1e3);return}F.value=s,y.value=!1,j()},q=()=>{C.push({name:"SyncHold"})},B=()=>{x.value=!x.value},E=()=>{p.value=!p.value},j=async()=>{if(d.value.length>0)try{const s=d.value.map(a=>a.code),t=await Y(s);t.length>0&&(d.value.forEach(a=>{const _=t.find(L=>L.code===a.code);_&&(a.change=V(_.change),a.dayProfit=a.holdAmount*(_.change/100))}),T.value=`数据刷新成功，已更新 ${t.length} 支基金`,m.value=!0,r.value&&clearTimeout(r.value),r.value=setTimeout(()=>{m.value=!1},3e3))}catch(s){console.error("批量获取实时数据失败:",s),T.value="数据刷新失败，请稍后重试",m.value=!0,r.value&&clearTimeout(r.value),r.value=setTimeout(()=>{m.value=!1},3e3)}};return U(()=>{j()}),G(()=>{i.value&&clearInterval(i.value),r.value&&clearTimeout(r.value)}),(s,t)=>(g(),b("div",Z,[e("div",ee,[e("div",te,[t[0]||(t[0]=e("div",{class:"flex items-center"},[e("div",{class:"w-10 h-10 rounded-full bg-gradient-to-r from-blue-500 to-indigo-500 flex items-center justify-center mr-3"},[e("i",{class:"fa fa-user text-white text-sm"})]),e("div",null,[e("div",{class:"text-lg font-bold text-gray-800"},"你好，投资者")])],-1)),e("div",se,o(I.value),1)]),t[1]||(t[1]=J('<div class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-4 border border-blue-100" data-v-245a7075><div class="flex items-start" data-v-245a7075><i class="fa fa-quote-left text-blue-300 mr-3 mt-1" data-v-245a7075></i><div class="flex-1" data-v-245a7075><p class="text-sm text-gray-700" data-v-245a7075>&quot;投资就像滚雪球，重要的是找到很湿的雪和很长的坡。&quot;</p><p class="text-xs text-gray-500 mt-1" data-v-245a7075>—— 沃伦·巴菲特</p></div><i class="fa fa-chart-line text-blue-400 ml-2" data-v-245a7075></i></div></div>',1))]),e("div",ae,[e("div",oe,[e("div",le,[e("div",ne,[t[2]||(t[2]=e("div",{class:"text-sm text-gray-500"},"账户资产",-1)),e("button",{onClick:B,class:"text-xs text-gray-400 hover:text-gray-600"},[e("i",{class:l(x.value?"fa fa-eye-slash":"fa fa-eye")},null,2)])]),e("div",re,o(x.value?u(D.value):"****.**"),1)]),e("div",ie,[e("div",de,[t[3]||(t[3]=e("div",{class:"text-sm text-gray-500"},"当日收益",-1)),e("button",{onClick:E,class:"text-xs text-gray-400 hover:text-gray-600"},[e("i",{class:l(p.value?"fa fa-eye-slash":"fa fa-eye")},null,2)])]),e("div",{class:l(["text-base font-bold",c(w)(P.value)])},o(p.value?(P.value>=0?"+":"")+u(P.value):"****.**"),3)]),e("div",ue,[t[4]||(t[4]=e("div",{class:"text-sm text-gray-500 mb-1"},"持仓盈亏",-1)),e("div",{class:l(["text-base font-bold",c(w)(f.value)])},o(f.value>=0?"+":"")+o(u(f.value)),3)]),e("div",ce,[t[5]||(t[5]=e("div",{class:"text-sm text-gray-500 mb-1"},"收益率",-1)),e("div",{class:l(["text-base font-bold",c(A)(k.value)])},o(k.value>=0?"+":"")+o(k.value.toFixed(2))+"% ",3)])])]),e("div",ve,[e("div",{class:"flex justify-between items-center mb-4"},[t[8]||(t[8]=e("h2",{class:"text-lg font-bold"},"我的持有基金",-1)),e("div",{class:"flex items-center gap-3"},[e("button",{onClick:q,class:"text-primary text-sm flex items-center"},[...t[6]||(t[6]=[e("i",{class:"fa fa-sync mr-1"},null,-1),e("span",null,"同步持仓",-1)])]),e("button",{onClick:N,class:"text-primary text-sm flex items-center"},[...t[7]||(t[7]=[e("i",{class:"fa fa-refresh mr-1"},null,-1),e("span",null,"刷新数据",-1)])])])]),y.value?(g(),b("div",me,[e("div",fe,[t[9]||(t[9]=e("i",{class:"fa fa-exclamation-triangle mr-2"},null,-1)),e("span",null,"请勿频繁刷新，"+o(h.value)+"秒后再试",1)])])):S("",!0),m.value?(g(),b("div",ge,[e("div",be,[t[10]||(t[10]=e("i",{class:"fa fa-check-circle mr-2"},null,-1)),e("span",null,o(T.value),1)])])):S("",!0),e("div",xe,[(g(!0),b(K,null,O(d.value,a=>(g(),b("div",{key:a.code,class:"border-b border-gray-100 pb-3 hover:bg-gray-50 rounded-lg p-2 cursor-pointer fund-item hover-scale",onClick:_=>H(a)},[e("div",he,[e("div",ye,[e("h3",_e,o(a.name),1),e("span",we,o(a.code),1)]),e("span",{class:l([c(A)(a.change),"font-medium px-2 py-1 rounded"])},o(a.change)+"%",3)]),e("div",Te,[e("div",Pe,[t[11]||(t[11]=e("span",{class:"text-neutral"},"当日收益:",-1)),e("span",{class:l([c(w)(a.dayProfit),"font-medium"])},o(u(a.dayProfit)),3)]),e("div",ke,[t[12]||(t[12]=e("span",{class:"text-neutral"},"持有收益:",-1)),e("span",{class:l([c(w)(a.holdProfit),"font-medium"])},o(u(a.holdProfit)),3)]),e("div",Ce,[t[13]||(t[13]=e("span",{class:"text-neutral"},"持有金额:",-1)),e("span",Fe,o(u(a.holdAmount)),1)]),e("div",De,[t[14]||(t[14]=e("span",{class:"text-neutral"},"持有天数:",-1)),e("span",je,o(a.holdDays)+"天",1)])]),e("div",Se,[e("div",{class:l([a.change>=0?"bg-rise":"bg-fall","h-full rounded-full"]),style:Q({width:Math.min(100,50+a.change*5)+"%"})},null,6)])],8,pe))),128))])])]))}},Ne=z(Ae,[["__scopeId","data-v-245a7075"]]);export{Ne as default};
